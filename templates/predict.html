<!DOCTYPE html>
<html>

<head>
    <title>Predict Image</title>
    <script>
        async function predictImage() {
            try {
                // Fetch the predict API
                const response = await fetch('/predict', {
                    method: 'POST'
                });

                // Check if the response is successful
                if (response.ok) {
                    // Convert the response to a blob
                    const blob = await response.blob();

                    // Remove the existing image element if it exists
                    const existingImgElement = document.getElementById('resizedImage');
                    if (existingImgElement) {
                        existingImgElement.remove();
                    }

                    // Create an image element and set the source to the fetched image
                    const img = document.createElement('img');
                    img.id = 'resizedImage';
                    img.onload = function () {
                        // Create a canvas element
                        const canvas = document.createElement('canvas');
                        const ctx = canvas.getContext('2d');

                        // Resize the image to 200x200 pixels
                        canvas.width = 200;
                        canvas.height = 200;
                        ctx.drawImage(img, 0, 0, 200, 200);

                        // Convert the canvas to a data URL
                        const resizedImage = canvas.toDataURL('image/jpeg');

                        // Create a new image element with the resized image
                        const resizedImgElement = document.createElement('img');
                        resizedImgElement.src = resizedImage;
                        resizedImgElement.id = 'resizedImage';

                        // Append the resized image to the body
                        document.body.appendChild(resizedImgElement);
                    };

                    img.src = URL.createObjectURL(blob);
                } else {
                    console.error('Failed to call predict API');
                }
            } catch (error) {
                console.error('Error calling predict API', error);
            }
        }
    </script>
</head>

<body>
    <button onclick="predictImage()">Predict</button>
</body>

</html>
